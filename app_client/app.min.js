!function(){function e(e,t){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/profile",{templateUrl:"/profile/profile.view.html",controller:"profileCtrl",controllerAs:"vm"}).when("/design/:designId",{templateUrl:"/design/design.view.html",controller:"designCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}function t(e,t,n){e.$on("$routeChangeStart",function(e,a,s){"/profile"!==t.path()||n.isLoggedIn()||t.path("/")})}angular.module("app",["ngRoute"]),angular.module("app").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",t])}(),function(){function e(e,t,n,a,s,o){function i(e,t){for(var n=2*Math.PI/e,a=t,s=t,o=[],i=0;e>i;i++){var c=a+t*Math.cos(i*n),r=s+t*Math.sin(i*n);o.push({x:c,y:r})}return o}var c=this;c.lastTime=(new Date).getTime(),c.designId=o.designId,c.currentUser=s.currentUser(),c.currentEmail=c.currentUser.email,c.currentName=c.currentUser.name,c.shareInfo={id:o.designId,email:"",permission:""},c.textOptions={text:"",fontFamily:"",fontSize:"",textAlign:""},c.copiedObject,c.copiedObjects=new Array,c.state=new Array,c.mods=0,c.shapeType="pointer",c.drawingMode=!0,c.isDown=!1,c.startPosition={},c.viewOnly=!1,c.canvas,c.init=function(){c.connectToSocket(),c.canvas=new fabric.Canvas("c",{renderOnAddRemove:!1}),c.canvas.selection=!1,c.setUpCanvas(),c.canvas.observe("mouse:down",c.objectSelectedHandler),a.getDesign(c.designId).success(function(e){c.setCanvasSize(e.design.size),c.canvasDesign=e.design.design,"edit"===e.permission?c.canvas.loadFromJSON(c.canvasDesign,c.canvas.renderAll.bind(c.canvas)):(c.canvas.loadFromJSON(c.canvasDesign,c.canvas.renderAll.bind(c.canvas),function(e,t){t.set("selectable",!1)}),c.viewOnly=!0),c.updateState(),c.designName=e.design.title}).error(function(e){console.log(e)})},c.objectSelectedHandler=function(e){console.log("in selected handler");var t=new Date,n=t.getTime();n-c.lastTime<400?(console.log("double clicked"),c.doubleClickedHandler(e)):(console.log(document.getElementById("shapeInfoDiv")),document.getElementById("shapeInfoDiv").style.display="none"),c.lastTime=n},c.doubleClickedHandler=function(e){var t=c.canvas.getActiveObject();console.log(t),$("#label").val(t.label),$("#comment").val(t.comment),$(".shapeInfoModal").css("display","inline-block")},c.saveShapeInfo=function(){var e=c.canvas.getActiveObject();console.log(e),e.label=$("#label").val(),e.comment=$("#comment").val(),c.updateDesign(),c.saveCanvas()},c.connectToSocket=function(){var e=location.pathname.split("/");socket=io("/"+e[1],{query:"room="+e[2]+"&name="+c.currentName}),socket.on("updateGroup",function(e){console.log(e);var t=$("#messages"),n=new Date,a=n.getHours()>=12?"pm":"am",s=n.getHours()-(n.getHours()>12?12:0),o=n.getMinutes()>=10?n.getMinutes():"0"+n.getMinutes(),i=s+":"+o+a;t.append($('<li class="message">').html("<p class='msgTime'>"+i+"</p><p class='userJoinedMessage'>"+e+"</p>")),t.scrollTop(t[0].scrollHeight),"none"==$(".chatBodyContainer").css("display")&&$(".chatHeader").addClass("notification")}),socket.on("designUpdate",function(e){c.viewOnly?(fabric.util.enlivenObjects([JSON.parse(e.shape)],function(t){t.set("selectable",!1),c.canvas.insertAt(t[0],e.index,!0)}),c.canvas.renderAll()):(console.log(e),fabric.util.enlivenObjects([JSON.parse(e.shape)],function(t){c.canvas.insertAt(t[0],e.index,!0),c.canvas.renderAll()})),c.updateState()}),socket.on("shapeToAdd",function(e){c.viewOnly?(fabric.util.enlivenObjects([JSON.parse(e.shape)],function(t){t.set("selectable",!1),c.canvas.insertAt(t[0],e.index,!0)}),c.canvas.renderAll()):fabric.util.enlivenObjects([JSON.parse(e.shape)],function(e){c.canvas.add(e[0]),c.canvas.renderAll()}),c.updateState()}),socket.on("shapeToRemove",function(e){c.viewOnly?(fabric.util.enlivenObjects([JSON.parse(e.shape)],function(t){c.canvas.insertAt(t[0],e.index,!0),c.canvas.remove(t[0])}),c.canvas.renderAll()):fabric.util.enlivenObjects([JSON.parse(e.shape)],function(t){c.canvas.insertAt(t[0],e.index,!0),c.canvas.remove(t[0]),c.canvas.renderAll()}),c.updateState()}),socket.on("messageRecieved",function(e){var t=$("#messages"),n=new Date,a=n.getHours()>=12?"pm":"am",s=n.getHours()-(n.getHours()>12?12:0),o=n.getMinutes()>=10?n.getMinutes():"0"+n.getMinutes(),i=s+":"+o+a;t.append($('<li class="message">').html("<p class='messageName'>"+e.name+"</p><p class='msgTime'>"+i+"</p><p class='msgText'>"+e.message+"</p>")),t.scrollTop(t[0].scrollHeight),"none"==$(".chatBodyContainer").css("display")&&$(".chatHeader").addClass("notification")})},c.copy=function(){if(c.canvas.getActiveGroup())for(var e in c.canvas.getActiveGroup().objects){var t=fabric.util.object.clone(c.canvas.getActiveGroup().objects[e]);t.set("top",t.top+5),t.set("left",t.left+5),c.copiedObjects[e]=t}else if(c.canvas.getActiveObject()){var t=fabric.util.object.clone(c.canvas.getActiveObject());t.set("top",t.top+5),t.set("left",t.left+5),c.copiedObject=t,c.copiedObjects=new Array}},c.paste=function(){if(c.copiedObjects.length>0)for(var e in c.copiedObjects)c.canvas.add(c.copiedObjects[e]);else c.copiedObject&&(c.canvas.add(c.copiedObject),c.updateDesign());c.canvas.renderAll(),c.updateState(),c.saveCanvas()},c.undo=function(){if(c.mods<c.state.length){var e=c.state.length-1-c.mods-1;e>-1&&(c.canvas.clear().renderAll(),c.canvas.loadFromJSON(c.state[e]),c.canvas.renderAll(),c.mods+=1,c.saveCanvas())}},c.redo=function(){c.mods>0&&(c.canvas.clear().renderAll(),c.canvas.loadFromJSON(c.state[c.state.length-1-c.mods+1]),c.canvas.renderAll(),c.mods-=1,c.saveCanvas())},c.sendMessage=function(){""!=$("#m").val()&&(c.message={name:c.currentName,message:$("#m").val()},$("#m").val(""),socket.emit("sendMessage",c.message))},document.addEventListener("keydown",function(e){switch(e.keyCode){case 46:if(c.canvas.getActiveObject()){var t=c.canvas.getActiveObject();return c.updateShapeDeletion(),c.canvas.remove(t),c.canvas.remove(t),c.canvas.renderAll(),c.updateState(),void c.saveCanvas()}break;case 16:c.keepSquare=!0;break;case 67:e.ctrlKey&&(e.preventDefault(),c.copy());break;case 86:e.ctrlKey&&(e.preventDefault(),c.paste());break;case 90:e.ctrlKey&&(e.preventDefault(),c.undo());break;case 89:e.ctrlKey&&(e.preventDefault(),c.redo())}}),document.addEventListener("keyup",function(e){if("text"==e.target.type||"comment"==e.target.id||"textValue"==e.target.id)return!1;switch(e.keyCode){case 16:c.keepSquare=!1;break;case 86:case 27:e.ctrlKey||c.changeToPointer();break;case 84:c.changeToText();break;case 83:c.changeToRect();break;case 80:c.changeToPolygon();break;case 69:c.changeToEllipse();break;case 73:c.changeToImgShape();break;case 76:c.changeToLine();break;case 82:c.changeToTriangle()}}),c.updateState=function(){var e=c.canvas.toDatalessJSON(["label","comment"]),t=JSON.stringify(e);c.state.push(t)},c.saveCanvas=function(){var e=c.canvas.toDatalessJSON(["label","comment"]),t=JSON.stringify(e);c.currentEmail=s.currentUser().email,c.design={id:c.designId,owner:c.currentEmail,design:t},a.saveDesign(c.design).success(function(e){}).error(function(e){console.log(e)})},c.updateDesign=function(){var e={index:c.canvas.getObjects().indexOf(c.canvas.getActiveObject()),shape:JSON.stringify(c.canvas.getActiveObject().toDatalessObject(["label","comment"]))};console.log(e),socket.emit("updateDesign",e)},c.updateShapeDeletion=function(){var e={index:c.canvas.getObjects().indexOf(c.canvas.getActiveObject()),shape:JSON.stringify(c.canvas.getActiveObject().toDatalessObject())};socket.emit("deleteShape",e)},c.shapeAdded=function(){var e={shape:JSON.stringify(c.canvas.getActiveObject().toDatalessObject(["label","comment"]))};console.log(e),socket.emit("addShape",e)},c.setCanvasSize=function(e){c.canvas.setWidth(e.width),c.canvas.setHeight(e.height)},c.changeToRect=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="rect",$("#rect").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToEllipse=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="ellipse",$("#ellipse").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToTriangle=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="triangle",$("#triangle").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToText=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="i-text",$("#i-text").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToImgShape=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="image",$("#image").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToPolygon=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="polygon",$("#polygon").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},c.changeToPointer=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="pointer",$("#pointer").addClass("selectedButton"),c.canvas.defaultCursor="default"},c.changeToLine=function(){$("#"+c.shapeType).removeClass("selectedButton"),c.shapeType="line",$("#line").addClass("selectedButton"),c.canvas.defaultCursor="crosshair",c.canvas.discardActiveObject().renderAll()},t.toggleChat=function(){"inline-block"==$(".chatBodyContainer").css("display")?$(".chatBodyContainer").css("display","none"):($(".chatBodyContainer").css("display","inline-block"),$(".chatHeader").removeClass("notification"))},c.setUpCanvas=function(){document.getElementById("exportLink").addEventListener("click",function(e){fabric.Canvas.supports("toDataURL")?(this.href=c.canvas.toDataURL({format:"jpeg"}),this.download=c.designName.replaceAll(" ","_")+".jpg"):alert("This browlser doesn't support exporting")}),c.canvas.on("mouse:down",function(e){c.drawingMode&&!c.viewOnly&&"pointer"!=c.shapeType&&(c.isDown=!0,c.startPosition.x=e.e.offsetX-5,c.startPosition.y=e.e.offsetY-5,c.drawingMode=!1,n.createShape({shapeType:c.shapeType,startPosition:c.startPosition},function(e){c.shape=e,c.canvas.add(c.shape),c.canvas.renderAll(),c.drawingMode=!0}))}),c.canvas.on("mouse:move",function(e){var t,n;if(c.isDown&&c.drawingMode&&!c.viewOnly&&"pointer"!=c.shapeType){switch(c.shapeType){case"rect":c.keepSquare?(t=e.e.offsetX-c.startPosition.x,n=t):(t=e.e.offsetX-c.startPosition.x,n=e.e.offsetY-c.startPosition.y),c.shape.setWidth(t),c.shape.setHeight(n),c.shape.setCoords();break;case"ellipse":var a=Math.abs(c.startPosition.x-e.e.offsetX)/2,s=Math.abs(c.startPosition.y-e.e.offsetY)/2;a>c.shape.strokeWidth&&(a-=c.shape.strokeWidth/2),s>c.shape.strokeWidth&&(s-=c.shape.strokeWidth/2),c.shape.set({rx:a,ry:s}),c.startPosition.x>e.e.offsetX?c.shape.set({originX:"right"}):c.shape.set({originX:"left"}),c.startPosition.y>e.e.offsetY?c.shape.set({originY:"bottom"}):c.shape.set({originY:"top"}),c.shape.setCoords();break;case"triangle":t=e.e.offsetX-c.startPosition.x,n=e.e.offsetY-c.startPosition.y,c.shape.setWidth(t),c.shape.setHeight(n),c.shape.setCoords();break;case"polygon":t=e.e.offsetX-c.startPosition.x,n=e.e.offsetY-c.startPosition.y;var o=t/2-4;c.shape.set({points:i(6,o)}),c.shape.setWidth(t),c.shape.setHeight(n),c.shape.set("left",c.startPosition.x),c.shape.set("top",c.startPosition.y),c.shape.setCoords();break;case"i-text":t=e.e.offsetX-c.startPosition.x,n=e.e.offsetY-c.startPosition.y,c.shape.setWidth(t),c.shape.set("left",c.startPosition.x),c.shape.set("top",c.startPosition.y),c.shape.setCoords();break;case"image":t=e.e.offsetX-c.startPosition.x,n=e.e.offsetY-c.startPosition.y,c.shape.setWidth(t),c.shape.setHeight(n),c.shape.setCoords();break;case"line":c.shape.set({x2:e.e.offsetX,y2:e.e.offsetY})}c.canvas.renderAll()}}),c.canvas.on("mouse:up",function(e){c.isDown=!1,c.drawingMode&&"pointer"!=c.shapeType&&("rect"===c.shapeType?e.e.offsetY-c.startPosition.y<0&&(c.shape.top=e.e.offsetY,c.shape.setHeight(-1*c.shape.getHeight()),c.shape.setCoords()):"triangle"===c.shapeType?c.offsetY-c.startPosition.y<0&&(c.shape.top=e.e.offsetY,c.shape.setHeight(-1*c.shape.getHeight()),c.shape.rotate(180),c.shape.setCoords()):"image"===c.shapeType||"line"===c.shapeType,c.canvas.setActiveObject(c.shape),c.updateState(),c.shapeAdded(),console.log("calling save canvas from mouse up"),c.saveCanvas()),c.drawingMode=!1}),c.canvas.on("selection:cleared",function(){$("#textOptions").css("display","none"),console.log(document.getElementById("shapeInfoDiv")),document.getElementById("shapeInfoDiv").style.display="none"}),c.canvas.on("object:selected",function(){if(!c.viewOnly){c.drawingMode=!1;var e=c.canvas.getActiveObject();$("#"+c.shapeType).removeClass("selectedButton"),$("#"+c.shapeType).addClass("selectedButton"),"i-text"===e.type?(c.textOptions.text=e.text,c.textOptions.fontFamily=e.fontFamily,c.textOptions.fontSize=e.fontSize,c.textOptions.textAlign=e.textAlign,t.$apply(),$("#font-family select").val(e.fontFamily),$("#font-size").val(e.fontSize),$("#textOptions").css("display","inline-block"),$("#textValue").bind("change keyup",function(){c.canvas.getActiveObject().text=this.value,c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#font-family").change(function(){c.canvas.getActiveObject().fontFamily=this.value,c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#font-size").change(function(){c.canvas.getActiveObject().fontSize=this.value,c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#font-align").change(function(){c.canvas.getActiveObject().fontAlign=this.value,c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#toggleBold").on("click",function(){c.canvas.getActiveObject().fontWeight="bold"===c.canvas.getActiveObject().fontWeight?"normal":"bold",c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#toggleItalic").on("click",function(){c.canvas.getActiveObject().fontStyle="italic"===c.canvas.getActiveObject().fontStyle?"normal":"italic",c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#toggleUnderline").on("click",function(){c.canvas.getActiveObject().textDecoration="underline"===c.canvas.getActiveObject().textDecoration?"":"underline",c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()}),$("#toggleLinethrough").on("click",function(){c.canvas.getActiveObject().textDecoration="line-through"===c.canvas.getActiveObject().textDecoration?"":"line-through",c.canvas.renderAll(),c.updateDesign(),c.updateState(),c.saveCanvas()})):$("#textOptions").css("display","none")}}),c.canvas.on("mouse:over",function(e){e.target&&"pointer"!=c.shapeType?(console.log("false selection"),e.target.set("selectable",!1)):e.target&&"pointer"==c.shapeType&&(console.log("make selectable again"),e.target.set("selectable",!0))}),c.canvas.on("object:moving",function(){c.saveCanvas(),c.updateDesign()}),c.canvas.on("object:scaling",function(){}),c.canvas.on("object:rotating",function(){}),c.canvas.on("selection:cleared",function(){c.drawingMode=!0}),c.canvas.observe("object:modified",function(e){console.log("object modified"),e.target.resizeToScale(),c.updateState(),c.updateDesign(),c.saveCanvas()}),c.openModal=function(){console.log("modal opened"),$(".shareModal").css("display","block")},c.closeModal=function(){$(".shareModal").css("display","none")},c.shareDesign=function(){c.viewOnly||a.shareDesign(c.shareInfo).success(function(e){c.closeModal(),alert("Project shared")}).error(function(e){console.log(e)})},fabric.Object.prototype.resizeToScale=function(){switch(this.type){case"rect":this.width*=this.scaleX,this.height*=this.scaleY,this.scaleX=1,this.scaleY=1;break;case"ellipse":this.rx*=this.scaleX,this.ry*=this.scaleY,this.width=2*this.rx,this.height=2*this.ry,this.scaleX=1,this.scaleY=1;break;case"triangle":this.width*=this.scaleX,this.height*=this.scaleY,this.scaleX=1,this.scaleY=1;break;case"polyline":case"polygon":break;case"image":this.width*=this.scaleX,this.height*=this.scaleY,this.scaleX=1,this.scaleY=1}}},c.init()}angular.module("app").controller("designCtrl",e),e.$inject=["$location","$scope","DrawingService","meanData","authentication","$routeParams"]}(),function(){function e(){console.log("home controller is running")}angular.module("app").controller("homeCtrl",e)}(),function(){function e(e,t,n,a){var s=this;s.user={},s.designs={},s.sharedDesigns={},s.currentEmail=n.currentUser().email,s.design={title:"",owner:s.currentEmail,design:"",size:""},t.getProfile().success(function(e){s.user=e,console.log(s.user.email),t.getDesigns(s.user.email).success(function(e){console.log(e),s.designs=e.designs,t.getSharedDesigns(s.user.email).success(function(e){s.sharedDesigns=e.sharedDesigns}).error(function(e){console.log(e)})}).error(function(e){console.log(e)})}).error(function(e){console.log(e)}),s.openModal=function(){console.log("modal opened"),$(".designModal").css("display","block")},a.openDiv=function(e){console.log(e),"custom"===e?(console.log("yay custom"),document.getElementById("customSizeDiv").style.display="block",document.getElementById("width").required=!0,document.getElementById("height").required=!0):(console.log("no custom"),document.getElementById("customSizeDiv").style.display="none",document.getElementById("height").required=!1,document.getElementById("width").required=!1)},s.closeModal=function(){$(".designModal").css("display","none")},s.timeSince=function(e){var t=new Date(e),n=["January","February","March","April","May","June","July","August","September","October","November","December"];return n[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()},s.submitNewDesign=function(){"Large"===s.design.size?s.design.size={width:1500,height:1e3}:"Medium"===s.design.size?s.design.size={width:800,height:800}:"Small"===s.design.size?s.design.size={width:400,height:600}:"Custom"===s.design.size&&(s.design.size={width:document.getElementById("width").value,height:document.getElementById("height").value}),t.createDesign(s.design).error(function(e){console.log(e)}).success(function(t){console.log("in controller"),console.log(t),e.path("/design/"+t.id)})}}angular.module("app").controller("profileCtrl",e),e.$inject=["$location","meanData","authentication","$scope"]}(),function(){function e(e,t,n){var a=this;a.credentials={email:"",password:""},a.onSubmit=function(){t.login(a.credentials).error(function(e){console.log(e),n.error=e.message}).then(function(){e.path("profile")})}}angular.module("app").controller("loginCtrl",e),e.$inject=["$location","authentication","$scope"]}(),function(){function e(e,t,n){var a=this;a.credentials={name:"",email:"",password:""},a.onSubmit=function(){console.log("submitting registration"),t.register(a.credentials).error(function(e){n.error=e.message}).then(function(){e.path("profile")})}}angular.module("app").controller("registerCtrl",e),e.$inject=["$location","authentication","$scope"]}(),function(){function e(e){var t={};return t.createShape=function(t,n){var a=null;console.log(t.shapeType),"rect"===t.shapeType?a=e.createRect:"ellipse"===t.shapeType?a=e.createEllipse:"triangle"===t.shapeType?a=e.createTriangle:"image"===t.shapeType?a=e.createImgShape:"i-text"===t.shapeType?a=e.createText:"polygon"===t.shapeType?a=e.createPolygon:"line"===t.shapeType&&(a=e.createLine),new a(t,function(e){n(e)})},t}angular.module("app").factory("DrawingService",e),e.$inject=["ShapeService"]}(),function(){function e(){function e(e,t){for(var n=2*Math.PI/e,a=t,s=t,o=[],i=0;e>i;i++){var c=a+t*Math.cos(i*n),r=s+t*Math.sin(i*n);o.push({x:c,y:r})}return o}var t={};return t.createRect=function(e,t){var n=new fabric.Rect({left:e.startPosition.x,top:e.startPosition.y,width:0,height:0,stroke:"black",strokeWidth:1,fill:"transparent"});n.shapeInfo={},n.label="",n.comment="",t(n)},t.createEllipse=function(e,t){var n=new fabric.Ellipse({left:e.startPosition.x,top:e.startPosition.y,originX:"left",originY:"top",rx:0,ry:0,fill:"transparent",stroke:"black",strokeWidth:1});n.label="",n.comment="",t(n)},t.createTriangle=function(e,t){var n=new fabric.Triangle({left:e.startPosition.x,top:e.startPosition.y,width:0,height:0,fill:"transparent",stroke:"black",strokeWidth:1});n.label="",n.comment="",t(n)},t.createText=function(e,t){var n=new fabric.IText("Text",{top:e.startPosition.y,left:e.startPosition.x,fontSize:18});n.label="",n.comment="",t(n)},t.createImgShape=function(e,t){var n;fabric.Image.fromURL("svgs/imageShape.svg",function(a){n=a.set({left:e.startPosition.x,top:e.startPosition.y,fill:"transparent",stroke:"black",originX:"left",originY:"top",strokeWidth:1,width:0,height:0}),n.label="",n.comment="",t(n)})},t.createLine=function(e,t){var n=[e.startPosition.x,e.startPosition.y,e.startPosition.x,e.startPosition.y];console.log(n);var a=new fabric.Line(n,{strokeWidth:3,fill:"black",stroke:"black",originX:"center",originY:"center"});a.label="",a.comment="",t(a)},t.createPolygon=function(t,n){var a=e(6,5),s=new fabric.Polygon(a,{stroke:"black",left:t.startPosition.x,top:t.startPosition.y,strokeWidth:2,fill:"transparent"},!1);s.label="",s.comment="",n(s)},t}angular.module("app").factory("ShapeService",e)}(),function(){function e(e,t){var n=function(e){t.localStorage["mean-token"]=e},a=function(){return t.localStorage["mean-token"]};logout=function(){t.localStorage.removeItem("mean-token")};var s=function(){var e,n=a();return n?(e=n.split(".")[1],e=t.atob(e),e=JSON.parse(e),e.exp>Date.now()/1e3):!1},o=function(){if(s()){var e=a(),n=e.split(".")[1];return n=t.atob(n),n=JSON.parse(n),{email:n.email,name:n.name}}};return register=function(t){return e.post("/api/register",t).success(function(e){n(e.token)}).error(function(e){})},login=function(t){return e.post("/api/login",t).success(function(e){n(e.token)})},{saveToken:n,getToken:a,logout:logout,isLoggedIn:s,currentUser:o,register:register,login:login,logout:logout}}angular.module("app").service("authentication",e),e.$inject=["$http","$window"]}(),function(){function e(e,t,n){var a=function(){return console.log(t.getToken()),e.get("/api/profile",{headers:{Authorization:"Bearer "+t.getToken()}})},s=function(t){return console.log(t),e.get("/api/designs",{params:{email:t}}).success(function(e){console.log(e)}).error(function(e){console.log(e)})},o=function(t){return e.get("api/designs/shared",{params:{email:t}}).success(function(e){console.log(e)}).error(function(e){console.log(e)})},i=function(n){return e.get("/api/design",{params:{id:n,email:t.currentUser().email}}).success(function(e){console.log(e)}).error(function(e){console.log(e)})},c=function(t){return e.post("/api/designs/save",t).success(function(e){console.log(e)})},r=function(t){return e.post("/api/designs/save",t).success(function(e){console.log("in data service"),console.log(e)}).error(function(e){console.log(e)})},l=function(t){return e.post("api/designs/share",t).success(function(e){console.log("in mean data")}).error(function(e){console.log(e)})};return{getProfile:a,getDesigns:s,getSharedDesigns:o,saveDesign:c,getDesign:i,createDesign:r,shareDesign:l}}angular.module("app").service("meanData",e),e.$inject=["$http","authentication","$location"]}(),function(){function e(e,t,n){n.isLoggedIn=function(){return t.isLoggedIn()},n.currentUser=function(){return n.isLoggedIn()?t.currentUser().name:void 0},console.log(n.isLoggedIn()),n.logOut=function(){t.logout(),e.path("/")}}angular.module("app").controller("navigationCtrl",e),e.$inject=["$location","authentication","$scope"]}(),function(){function e(){return{restrict:"A",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("app").directive("navigation",e)}();
//# sourceMappingURL=app.min.js.map
